<div class="container tech-notes">
    <div class="row flex-xl-nowrap">

        <div id="tech-notes-sidebar" class="col-12 col-md-3 col-xl-3 sidebar">
            <form class="search d-flex align-items-center">
                <span style="position: relative; display: inline-block; direction: ltr;">
                    <input type="search" class="form-control" id="search-input" placeholder="Filter..." autocomplete="off" spellcheck="false" v-model="search"/>
                </span>
                <button v-on:click="toogle_nav" type="button" class="btn d-md-none">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="30" height="30" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M4 7h22M4 15h22M4 23h22"></path></svg>
                </button>
            </form>
          
            <nav class="collapse" v-bind:class="{ show: show }">
                <ul class="nav sidenav" v-for="item in filteredItems">
                    {% raw %}
                    <li><a :href="item.url">{{ item.title }}</a></li>
                    {% endraw %}
                </ul>
            </nav>
        </div>

        <main class="col-12 col-md-9 col-xl-9 content">
            <article>
                {% if article.video_id | length > 1 %}
                <div class="embed-responsive embed-responsive-16by9">
                    <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/{{ article.video_id }}" frameborder="0" allow="encrypted-media" allowfullscreen></iframe>
                </div>
                {% endif %}
                <h1>{{ article.title }}</h1>
                {{ article.content }}
            </article>
        </main>
    </div>
</div>

<script>
items = [
    {% for article in articles %}
    {% if article.category == "tech-notes" and article.title != "Tech Notes" %}
    { title: "{{ article.title }}", url: "/{{ article.url }}", tags: [{% for tag in article.tags %}"{{ tag }}",{% endfor %}] },
    {% endif %}
    {% endfor %}
]

function contains(text, search) {
    return text.toLowerCase().indexOf(search.toLowerCase()) > -1
}

var tech_notes = new Vue({
    el: '#tech-notes-sidebar',
    data: {
        show: false,
        search: '',
        items: items
    },

    methods: {
        toogle_nav: function(event) {
            this.show = !this.show;
        }
    },

    computed: {
        filteredItems() {
            return this.items.filter(item => {
                searches = [item.title].concat(item.tags);
                query = searches.map(x => contains(x, this.search));
                return query.some(x => x == true);
            })
        }
    }
})

</script>
